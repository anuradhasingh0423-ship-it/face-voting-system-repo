<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard - Face Voting System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            background: linear-gradient(120deg, #f2f5fa 60%, #e5f3fe 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', 'Poppins', system-ui, sans-serif;
        }
        .dashboard-cards {
            max-width: 900px;
            margin: 60px auto;
            display: grid;
            gap: 28px;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        }
        .admin-card {
            border: none;
            border-radius: 18px;
            box-shadow: 0 6px 36px rgba(23,36,49,.09);
            padding: 0;
        }
        .admin-card .card-header {
            background: #fafcfe;
            color: #234b86;
            font-weight: bold;
            border-bottom: none;
            border-radius: 18px 18px 0 0;
            font-size: 1.2rem;
        }
        .admin-card .card-body {
            padding: 32px 22px 28px 22px;
        }
        .admin-card .btn { font-size: 1.12rem; }
        .active-status {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <h1 class="text-center my-4" style="color:#234b86;font-weight:700;">üó≥Ô∏è Face Voting Admin Dashboard</h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="container mt-3">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert" style="max-width: 900px; margin: 0 auto;">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="dashboard-cards">

        <div class="card admin-card">
            <div class="card-header">Voting Station Control</div>
            <div class="card-body">
                
                {% if voting_active %}
                    <p class="active-status text-success">‚úÖ VOTING IS ACTIVE</p>
                    <form action="{{ url_for('admin_stop_voting') }}" method="post">
                        <button type="submit" class="btn btn-danger w-100 mb-3" title="Stop voting and allow final result viewing">
                            üõë Stop Voting
                        </button>
                    </form>
                    <a href="{{ url_for('start_voting_station_route') }}" 
                        class="btn btn-secondary w-100" data-bs-toggle="tooltip" title="Launch voter verification window">
                        Launch Voter Verification
                    </a>
                {% else %}
                    <p class="active-status text-secondary">üö´ VOTING IS STOPPED</p>
                    <form action="{{ url_for('admin_start_voting') }}" method="post">
                        <button type="submit" class="btn btn-primary w-100 mb-3" title="Start voting to allow remote voter access">
                            ‚ñ∂Ô∏è Start Voting Station
                        </button>
                    </form>
                {% endif %}

                <hr>

                <div class="mt-3">
                    <h6 class="text-primary">Current Vote Count (All Elections)</h6>
                    {% if vote_summary %}
                        <p>Total Elections Counted: {{ vote_summary|length }}</p>
                    {% else %}
                        <p>No votes recorded yet.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="card admin-card">
            <div class="card-header">Election Management</div>
            <div class="card-body">
                <a href="{{ url_for('launch_desktop_dashboard') }}" 
                    class="btn btn-warning w-100 mb-3" 
                    data-bs-toggle="tooltip" title="View live vote dashboard with real-time results">
                    üìä View Live Vote Dashboard
                </a>
                <a href="{{ url_for('election_overview') }}" class="btn btn-warning w-100 mb-3" 
                    data-bs-toggle="tooltip" title="View election summary and vote counts">
                    üèõÔ∏è Election Overview
                </a>
            </div>
        </div>

        <div class="card admin-card">
            <div class="card-header">üìä Election Results</div>
            <div class="card-body">
                <a href="{{ url_for('results_vidhansabha') }}" class="btn btn-info w-100 mb-2"
                    data-bs-toggle="tooltip" title="View Vidhan Sabha results">
                    Vidhan Sabha Results
                </a>
                <a href="{{ url_for('results_loksabha') }}" class="btn btn-info w-100 mb-2"
                    data-bs-toggle="tooltip" title="View Lok Sabha results">
                    Lok Sabha Results
                </a>
                <a href="{{ url_for('results_rajyasabha') }}" class="btn btn-info w-100 mb-2"
                    data-bs-toggle="tooltip" title="View Rajya Sabha results">
                    Rajya Sabha Results
                </a>
                <a href="{{ url_for('results_panchayat') }}" class="btn btn-info w-100"
                    data-bs-toggle="tooltip" title="View Panchayat results">
                    Panchayat Results
                </a>
            </div>
        </div>

        <div class="card admin-card">
            <div class="card-header">Data & Session</div>
            <div class="card-body">
                <form id="clear-data-form" action="{{ url_for('clear_data') }}" method="post" class="mb-3">
                    <button type="button" class="btn btn-danger w-100"
                            data-bs-target="#confirmClearModal" data-bs-toggle="modal"
                            title="Remove ALL voting data permanently!">
                        üóëÔ∏è Remove All Vote & Voter Data
                    </button>
                </form>
                <form action="{{ url_for('logout') }}" method="get">
                    <button type="submit" class="btn btn-secondary w-100"
                            data-bs-toggle="tooltip" title="Logout from admin panel">
                        üö™ Logout
                    </button>
                </form>
            </div>
        </div>

    </div>

    <div class="modal fade" id="confirmClearModal" tabindex="-1" aria-labelledby="confirmClearLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="confirmClearLabel">Confirm Data Deletion</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are you sure you want to remove <strong>all vote and voter data</strong>? This action is irreversible.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button id="confirmClearBtn" type="button" class="btn btn-danger">Yes, Remove All Data</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
      })

      document.getElementById('confirmClearBtn').addEventListener('click', function () {
        document.getElementById('clear-data-form').submit();
      })
    </script>
</body>
</html>
